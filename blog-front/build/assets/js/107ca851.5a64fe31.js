"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[8103],{57843:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>h,contentTitle:()=>a,default:()=>o,frontMatter:()=>n,metadata:()=>i,toc:()=>l});var c=r(13274),t=r(1780);const n={id:"es-search-phase",slug:"/ai-arch/elasticsearch/es-search-phase",title:"ES\u67e5\u8be2\u6d41\u7a0b"},a=void 0,i={id:"ai-arch/elasticsearch/es-search-phase",title:"ES\u67e5\u8be2\u6d41\u7a0b",description:"es\u96c6\u7fa4\u67e5\u8be2\u6d41\u7a0b",source:"@site/docs/ai-arch/elasticsearch/es-search-phase.md",sourceDirName:"ai-arch/elasticsearch",slug:"/ai-arch/elasticsearch/es-search-phase",permalink:"/docs/ai-arch/elasticsearch/es-search-phase",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedAt:1743935803,formattedLastUpdatedAt:"Apr 6, 2025",frontMatter:{id:"es-search-phase",slug:"/ai-arch/elasticsearch/es-search-phase",title:"ES\u67e5\u8be2\u6d41\u7a0b"},sidebar:"ai-arch",previous:{title:"ES\u642d\u5efa",permalink:"/docs/ai-arch/elasticsearch/es-deploy"},next:{title:"ES\u5411\u91cf\u641c\u7d22\u548cLucene\u6267\u884c\u539f\u7406",permalink:"/docs/ai-arch/elasticsearch/es-knn"}},h={},l=[{value:"es\u96c6\u7fa4\u67e5\u8be2\u6d41\u7a0b",id:"es\u96c6\u7fa4\u67e5\u8be2\u6d41\u7a0b",level:2},{value:"search\u5904\u7406\u6d41\u7a0b",id:"search\u5904\u7406\u6d41\u7a0b",level:2},{value:"Reference",id:"reference",level:2}];function d(e){const s={a:"a",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",...(0,t.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(s.h2,{id:"es\u96c6\u7fa4\u67e5\u8be2\u6d41\u7a0b",children:"es\u96c6\u7fa4\u67e5\u8be2\u6d41\u7a0b"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.img,{alt:"img_2.png",src:r(26326).A+"",width:"1023",height:"490"})}),"\n",(0,c.jsx)(s.h2,{id:"search\u5904\u7406\u6d41\u7a0b",children:"search\u5904\u7406\u6d41\u7a0b"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.img,{alt:"img_3.png",src:r(46743).A+"",width:"1280",height:"941"})}),"\n",(0,c.jsxs)(s.ol,{children:["\n",(0,c.jsx)(s.li,{children:"Get Remote Cluster Shard \u5224\u65ad\u662f\u5426\u9700\u8981\u96c6\u7fa4\u8bbf\u95ee"}),"\n",(0,c.jsx)(s.li,{children:"Get Search Shard Iterator \u83b7\u53d6\u8981\u8bbf\u95ee\u7684shard"}),"\n",(0,c.jsxs)(s.li,{children:["For Every Shard",":Perform"," \u5224\u65adshard\u60c5\u51b5\uff0c\u6267\u884c\u540e\u9762\u6d41\u7a0b"]}),"\n",(0,c.jsx)(s.li,{children:"Send Request To Query Shard \u5c06query\u9636\u6bb5\u7684\u67e5\u8be2\u53d1\u7ed9shard"}),"\n",(0,c.jsx)(s.li,{children:"merge doc \u5408\u5e76\u7b56\u7565\u662f\u7ef4\u62a4\u4e00\u4e2aTop N\u5927\u5c0f\u7684\u4f18\u5148\u7ea7\u961f\u5217\uff0c\u6bcf\u5f53\u6536\u5230\u4e00\u4e2ashard\u7684\u8fd4\u56de\uff0c\u5c31\u628a\u7ed3\u679c\u653e\u5165\u4f18\u5148\u7ea7\u961f\u5217\u505a\u4e00\u6b21\u6392\u5e8f\uff0c\u76f4\u5230\u6240\u6709\u7684Shard\u90fd\u8fd4\u56de\u540e\u505a\u7ffb\u9875\u903b\u8f91\u3002"}),"\n",(0,c.jsx)(s.li,{children:"Send Request To Fetch Shard \u6267\u884cfetch\u9636\u6bb5"}),"\n"]}),"\n",(0,c.jsx)(s.p,{children:"query\u9636\u6bb5"}),"\n",(0,c.jsxs)(s.ol,{children:["\n",(0,c.jsx)(s.li,{children:"Create Search Context"}),"\n",(0,c.jsx)(s.li,{children:"Parse Query \u89e3\u6790query"}),"\n",(0,c.jsx)(s.li,{children:"Get From Cache \u67e5\u8be2\u7f13\u5b58"}),"\n",(0,c.jsx)(s.li,{children:"Add Collectors \u7ec4\u88c5collector\uff0ccollectors\u662f\u6536\u96c6\u67e5\u8be2\u7ed3\u679c\uff0c\u5b9e\u73b0\u6392\u5e8f\uff0c\u5bf9\u81ea\u5b9a\u4e49\u7ed3\u679c\u96c6\u8fc7\u6ee4\u548c\u6536\u96c6\u7b49"}),"\n",(0,c.jsx)(s.li,{children:"lucene::search \u6267\u884clucene\u67e5\u8be2"}),"\n",(0,c.jsx)(s.li,{children:"rescore"}),"\n",(0,c.jsx)(s.li,{children:"suggest::execute()"}),"\n",(0,c.jsx)(s.li,{children:"aggregation::execute()"}),"\n"]}),"\n",(0,c.jsx)(s.p,{children:"fetch\u9636\u6bb5"}),"\n",(0,c.jsxs)(s.ol,{children:["\n",(0,c.jsx)(s.li,{children:"\u901a\u8fc7docid\u83b7\u53d6\u5b8c\u6210\u7684doc\u6587\u6863\u3002\n\u4e00\u822c\u641c\u7d22\u7cfb\u7edf\u90fd\u6709query\u548cfetch\u4e24\u9636\u6bb5\u3002"}),"\n"]}),"\n",(0,c.jsx)(s.h2,{id:"reference",children:"Reference"}),"\n",(0,c.jsxs)(s.p,{children:["\u8bfb\u6e90\u7801\uff1a\n",(0,c.jsx)(s.a,{href:"https://blog.csdn.net/qq_42801937/article/details/140446384",children:"https://blog.csdn.net/qq_42801937/article/details/140446384"}),"\n",(0,c.jsx)(s.a,{href:"https://lanffy.github.io/2019/04/08/Elasticsearch-Compile-Source-And-Debug",children:"https://lanffy.github.io/2019/04/08/Elasticsearch-Compile-Source-And-Debug"}),"\n",(0,c.jsx)(s.a,{href:"https://www.itshujia.com/read/elasticsearch/368.html",children:"https://www.itshujia.com/read/elasticsearch/368.html"})]})]})}function o(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,c.jsx)(s,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}},46743:(e,s,r)=>{r.d(s,{A:()=>c});const c=r.p+"assets/images/search_process-a419ffb6c99a769dcf611f3fec5ff239.png"},26326:(e,s,r)=>{r.d(s,{A:()=>c});const c=r.p+"assets/images/serach_step-a24d02df4b5be8761beda1dc298fd4cb.png"},1780:(e,s,r)=>{r.d(s,{R:()=>a,x:()=>i});var c=r(79474);const t={},n=c.createContext(t);function a(e){const s=c.useContext(n);return c.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),c.createElement(n.Provider,{value:s},e.children)}}}]);